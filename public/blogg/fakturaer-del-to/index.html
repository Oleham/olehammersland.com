<!DOCTYPE html>
<html lang="en-US">

<head>
  <meta http-equiv="X-Clacks-Overhead" content="GNU Terry Pratchett" />
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="shortcut icon" href="https://www.olehammersland.com/images/favicon.png" />
<title>Fakturaer del to | Ole Hammersland</title>
<meta name="title" content="Fakturaer del to" />
<meta name="description" content="Jeg har forbedret min hjemmelagde fakturagenerator. Den tar n√• i mye st√∏rre grad hensyn til formkravene ved MVA-meldingen fra Skatteetaten. Det er automatisering av en kjedelig oppgave, som mange med enkeltpersonforetak sikkert kjenner seg igjen i." />
<meta name="keywords" content="automatisering,effektivisering,python,xtrf,enkeltpersonforetak," />


<meta property="og:title" content="Fakturaer del to" />
<meta property="og:description" content="Jeg har forbedret min hjemmelagde fakturagenerator. Den tar n√• i mye st√∏rre grad hensyn til formkravene ved MVA-meldingen fra Skatteetaten. Det er automatisering av en kjedelig oppgave, som mange med enkeltpersonforetak sikkert kjenner seg igjen i." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.olehammersland.com/blogg/fakturaer-del-to/" />
<meta property="og:image" content="https://www.olehammersland.com/images/share.png"/>
<meta property="article:published_time" content="2021-03-03T20:34:36+01:00" />
<meta property="article:modified_time" content="2021-03-03T20:34:36+01:00" />



<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://www.olehammersland.com/images/share.png"/>

<meta name="twitter:title" content="Fakturaer del to"/>
<meta name="twitter:description" content="Jeg har forbedret min hjemmelagde fakturagenerator. Den tar n√• i mye st√∏rre grad hensyn til formkravene ved MVA-meldingen fra Skatteetaten. Det er automatisering av en kjedelig oppgave, som mange med enkeltpersonforetak sikkert kjenner seg igjen i."/>



<meta itemprop="name" content="Fakturaer del to">
<meta itemprop="description" content="Jeg har forbedret min hjemmelagde fakturagenerator. Den tar n√• i mye st√∏rre grad hensyn til formkravene ved MVA-meldingen fra Skatteetaten. Det er automatisering av en kjedelig oppgave, som mange med enkeltpersonforetak sikkert kjenner seg igjen i.">
<meta itemprop="datePublished" content="2021-03-03T20:34:36+01:00" />
<meta itemprop="dateModified" content="2021-03-03T20:34:36+01:00" />
<meta itemprop="wordCount" content="1331">
<meta itemprop="image" content="https://www.olehammersland.com/images/share.png"/>



<meta itemprop="keywords" content="automatisering,effektivisering,python,xtrf,enkeltpersonforetak," />

<meta name="referrer" content="no-referrer-when-downgrade" />

  <style>

  :root {
    --main-color: rgb(35, 19, 253);
}

  @import url('fonts/inter.css');
    html { 
      font-family: 'Inter', sans-serif; 
    }
  @supports (font-variation-settings: normal) {
    html { 
      font-family: 'Inter var', sans-serif; 
    }
  }

  body {
    margin: auto;
    font-size: 1.2rem;
    padding: 20px;
    max-width: 720px;
    text-align: left;
    background-color: #fff;
    word-wrap: break-word;
    overflow-wrap: break-word;
    line-height: 1.5;
    color: #444;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6,
  strong,
  b {
    color: #222;
  }

  a {
    color: #3273dc;
     
  }

  .title {
    text-decoration: none;
    border: 0;
  }

 .logo-icon {
    min-width: 100px;
    margin-right: 10px;
  }

  .logo-box {
    display:flex;
    width: 100%;
  }

  .title span {
    font-weight: 400;
  }

  #main-nav a {
    font-size: 1.5rem;
    margin-right: 5px;
    padding-right: 10px;
    color:#444;
    text-decoration: none;
    border-right: 2px solid var(--main-color);
  }

  #main-nav a:hover {
    color:rgb(145, 139, 139)
  }

  #main-nav a:last-of-type {
    border-right: none;
  }

  #burger {
    display: none;
    margin: 10px;
  }

  .burger-line {
    height: 5px;
    width: 35px;
    background-color:var(--main-color);
    margin-bottom: 5px;
  }

  textarea {
    width: 100%;
    font-size: 16px;
  }

  input {
    font-size: 16px;
  }

  content {
    line-height: 1.6;
  }

  table {
    width: 100%;
  }

  img {
    max-width: 100%;
  }

  code {
    padding: 2px 5px;
    background-color: #f2f2f2;
  }

  pre code {
    color: #222;
    display: block;
    padding: 20px;
    white-space: pre-wrap;
    font-size: 14px;
  }

  blockquote {
    border-left: 1px solid #999;
    color: #222;
    padding-left: 20px;
    font-style: italic;
  }

  footer {
    padding: 25px;
    text-align: center;
  }

  .helptext {
    color: #777;
    font-size: small;
  }

  .errorlist {
    color: #eba613;
    font-size: small;
  }

  .blog-posts a {
    text-decoration: none;
    color:#444;
  }

  .blog-posts h3 {
    border-bottom: 1px solid var(--main-color);
  }

  .blog-posts h3::first-letter {
    color:var(--main-color);
  }

  .blog-posts a:hover, .blog-posts h3:hover {
    color:rgb(145, 139, 139);
  }

  #pagination {
    margin: auto;
    width: 100%;
    align-items: center;
    font-size: 1.5rem;
    border: 1px solid var(--main-color);
    margin-bottom: 20px;
    margin-top: 20px;
    text-align: center;
  }
  
  #pagination span {
    padding-right: 20px;
    padding-left: 20px;
  }

  #pagination button {
    border: none;
    background-color: inherit;
    font-size: inherit;
    color: inherit;
    cursor: pointer;
  }

  div#TableOfContents {
    padding-top: 10px; 
  }
  #TableOfContents li {
    list-style: circle;
  }

  @media screen and (max-width: 700px) {
    #burger {
      display:block
    }

    #main-nav {
      display: absolute;
      transform: translateY(calc(-100vh));
      height: 5px;
      transition: 1s;
      border-left: 2px solid var(--main-color);
      padding-left: 10px;
    }

    #main-nav a {
      border:none;
    }

    #main-nav.open-burger {
      display: flex;
      height: unset;
      flex-direction: column;
      transition: 1s;
      font-size: 2rem;
      transform: translateY(0);
    }

    .open-burger .burger-line {
      margin:none;
      transform: none;
    }

   .open-burger #line1 {
      transform: rotate(45deg) translateY(6px) translateX(1px);
      margin:none;
      transition: 1s ease-out;
    }
    .open-burger #line2 {
      display:none;
    }
    .open-burger #line3 {
      transform: rotate(-45deg) translateY(-6px);
      margin:none;
      transition: 1s ease-out;
    }
  }

  @media screen and (max-width: 400px) {
    .logo-box {
      flex-direction: column;
    }

    #burger {
      align-self: flex-end;
    }
  }
</style>

</head>

<body>
  <header>
<div class="logo-box">
  <a href="/" class="title">
    <img class="logo-icon" src="/images/book.png">
  </a>
  <h2>Ole Hammersland</h2>
  <div id="burger">
      <div class="burger-line" id="line1"></div>
      <div class="burger-line" id="line2"></div>
      <div class="burger-line" id="line3"></div>
  </div>
</div>
<nav id="main-nav"><a href="/">Hjem</a>

<a href="/om/">Om</a>

<a href="/spr%C3%A5ktjenester/">Spr√•ktjenester</a>

<a href="/sykkel/">Sykkel</a>

<a href="/bokhylla/">üìö</a>


<a href="/blogg">Blogg</a>

</nav>

</header>
  <main>



<div id="TableOfContents">
<p><strong>Innhold:</strong></p>
<nav id="TableOfContents">
  <ol>
    <li><a href="#utfordringene">Utfordringene</a></li>
    <li><a href="#ny-utforming">Ny utforming</a></li>
    <li><a href="#gjennomgang-av-nye-hammer-faktura">Gjennomgang av nye Hammer Faktura</a>
      <ol>
        <li><a href="#1-initialisere-kunde-bank-og-faktura">1. Initialisere kunde, bank og faktura</a></li>
        <li><a href="#2-mat-inn-alle-oppdrag">2. Mat inn alle oppdrag</a></li>
        <li><a href="#3-generer-fakturaen-og-skriv-til-fil">3. Generer fakturaen og skriv til fil</a></li>
      </ol>
    </li>
    <li><a href="#andre-forbedringer">Andre forbedringer</a></li>
  </ol>
</nav>

</div>
<h1>Fakturaer del to</h1>
<p>
  <i>
    <time datetime='2021-03-03' pubdate>
      F√∏rst publisert: 03.03.2021
    </time>
  </i>
</p>


<content>
  <p>Fakturaer, fakturaer. Jeg tenker fortsatt utelukkende p√• fakturaer.</p>
<p>I forrige blogginnlegg skrev jeg om <a href="/blogg/fakturagenerator-i-python">en fakturagenerator jeg har skrevet i Python</a>. Et g√∏y prosjekt som jeg satt sammen i l√∏pet av noen dager innimellom oversettelsesoppdragene. Denne uken skulle Hammer Faktura settes p√• pr√∏ve, og den bestod!</p>
<p>I l√∏pet av 3 sekunder hadde jeg lastet ned informasjonen om 500 mini-oppdrag fra XTRF, fordelt disse p√• tre fakturaer basert p√• avdeling og tegnet opp tre fine fakturaer med fakturanummer, forfallsdato, bankopplysninger og kundenes adresser.</p>
<p><img src="/images/blogg/hammer-faktura-faktura_hf.jpg" alt="Den forrige fakturaen!"></p>
<p>Resultatet ser fint ut. I prinsippet speiler det opplysningene i XTRF helt og holdent.</p>
<h2 id="utfordringene">Utfordringene</h2>
<p>Den siste uken har jeg imidlertid hatt den tvilsomme gleden av √• fylle ut min f√∏rste MVA-melding. N√• som jeg har v√¶rt i gjennom den prosessen, skj√∏nner jeg mer av hva som er nyttig i forbindelse med fakturaer. Jeg m√•tte for eksempel stadig konsultere kalkulatoren for √• finne tall som ikke var skrevet eksplisitt p√• fakturaen, bruttoprisen p√• enkeltjobber eller sammenlagt MVA. Om jeg en dag m√• f√∏re opplysningene inn i andre skjemaer eller regnskapsark, vil det potensielt bety masse omregning.</p>
<p>Det jeg p√• den andre <em>siden ikke hadde bruk for i det hele tatt</em>, var opplysninger som den interne jobb-ID-en til XTRF, oppdragstypen, etc. En faktura er en salgsdokumentasjon som skal dokumentere salget, pengene som skifter h√•nd og hvilke forpliktelser som oppst√•r med hensyn til MVA-registeret. Det er et dokument som skal regnskapsf√∏res og v√¶re etterettelig. I MVA-meldingen er det helt ubetydelig om oppdraget var oversettelse eller korrekturlesning ‚Äì man trenger bare ha en passe god beskrivelse av hva slags arbeid som har blitt utf√∏rt. Det er bel√∏pene som teller.</p>
<p>Derfor har jeg gitt programmet en ordentlig overhaling, oppdatert fakturamalene og ellers fikset opp i en del sm√•ting som jeg har manglet.</p>
<h2 id="ny-utforming">Ny utforming</h2>
<p><img src="/images/blogg/hammer-faktura-eksempel-ny-faktura.jpg" alt="Ny utforming p√• fakturaen"></p>
<p>N√• har jeg presset de tidligere spaltene navn + type, som jo egentlig var kategorier fra XTRF, inn p√• en linje som heter &ldquo;Beskrivelse&rdquo;. Her kan jeg legge inn en generell varebeskrivelse. Jeg beholder ID-kolonnen, fordi jeg ser for meg at den kan brukes i mange sammenhenger. Jeg har lagt til en egen MVA-utregning p√• hver eneste post, hvilket gj√∏r at fakturaen er mye mer eksplisitt. Dessuten har jeg lagt til en utregning for totalt beregnet MVA.</p>
<p>Jeg kunne ikke dy meg, og la ogs√• til en liten gul farge nederst ‚Äì i tr√•d med den klassiske norske giroen.</p>
<h2 id="gjennomgang-av-nye-hammer-faktura">Gjennomgang av nye Hammer Faktura</h2>
<p>I det nye programmet har jeg lagt til to nye klasser: Bank og Faktura. Det slo meg at jeg ikke ville oppgi min egen bankinformasjon p√• Github, s√• n√• er ikke lenger bankopplysningene statiske inne i programmet.</p>
<p>N√• som mye av informasjonen var blitt sortert etter Kunde og Bank, slo deg meg som inkonsekvent at fakturanummer og forfallsdato ligger lagret direkte i fakturageneratoren. Derfor ligger den informasjonen n√• i en egen Faktura-klasse.</p>
<div class="highlight"><pre style="color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#cdcd00">class</span> <span style="color:#00cdcd">Bank</span>():

	<span style="color:#cdcd00">def</span> __init__(self, konto, iban, bic, bank):
		self<span style="color:#39c">.</span>konto <span style="color:#39c">=</span> konto
		self<span style="color:#39c">.</span>iban <span style="color:#39c">=</span> iban
		self<span style="color:#39c">.</span>bic <span style="color:#39c">=</span> bic
		self<span style="color:#39c">.</span>bank <span style="color:#39c">=</span> bank

<span style="color:#cdcd00">class</span> <span style="color:#00cdcd">Faktura</span>():

	<span style="color:#cdcd00">def</span> __init__(self):
		self<span style="color:#39c">.</span>id <span style="color:#39c">=</span> self<span style="color:#39c">.</span>make_invoice_number()
		self<span style="color:#39c">.</span>dato, self<span style="color:#39c">.</span>forfall <span style="color:#39c">=</span> self<span style="color:#39c">.</span>get_invoice_dates()
</code></pre></div><p>Jobben med √• faktisk skape fakturaen har blitt flyttet til en fjerde klasse, som heter Generator. Dermed er oppgavefordelingen slik:</p>
<dl>
<dt><code>Kunde()</code></dt>
<dd>Holder informasjon om kunden. Dette inkluderer ogs√• informasjon om MVA-sats og valuta.</dd>
<dt><code>Faktura()</code></dt>
<dd>Inneholder metainformasjon om fakturaen:  dato, forfall og fakturanr.</dd>
<dt><code>Bank()</code></dt>
<dd>Inneholder betalingsinformasjon som kontonr, IBAN etc.</dd>
<dt><code>Generator()</code></dt>
<dd>har som oppgave √• skape fakturaen. Skaper en tabell med metoden <code>add_to_invoice</code> og fyller inn metainformasjon fra Kunde, Faktura og Bank.</dd>
</dl>
<h3 id="1-initialisere-kunde-bank-og-faktura">1. Initialisere kunde, bank og faktura</h3>
<p>Det f√∏rste som m√• gj√∏res, er √• initialisere Kunde og Bank. Faktura skapes fortsatt automatisk.</p>
<div class="highlight"><pre style="color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000080"># Importer modulen</span>
<span style="color:#cd00cd">import</span> hammer_faktura

<span style="color:#000080"># Initialiser Kunde og Bank.</span>
<span style="color:#000080"># Initialiser selve Generatoren.</span>
<span style="color:#000080"># Faktura initialiseres automatisk med datoer og id.</span>
kunde <span style="color:#39c">=</span> hammer_faktura<span style="color:#39c">.</span>Kunde(<span style="color:#cd0000">&#34;Kunde AS&#34;</span>, <span style="color:#cd0000">&#34;123456789&#34;</span>, <span style="color:#cd0000">&#34;Adresseveien 4&#34;</span>)
bank <span style="color:#39c">=</span> hammer_faktura<span style="color:#39c">.</span>Bank(<span style="color:#cd0000">&#34;XX.XXX.XXX..XX&#34;</span>,
        	<span style="color:#cd0000">&#34;NOXX.XXXX.XXXX.XX&#34;</span>,
        	<span style="color:#cd0000">&#34;NKSVP&#34;</span>,
        	<span style="color:#cd0000">&#34;Banken AS&#34;</span>)

generator <span style="color:#39c">=</span> hammer_faktura<span style="color:#39c">.</span>Generator(kunde, bank)
</code></pre></div><p>Viktig √• merke seg at man ogs√• kan legge til to valgfrie argumenter n√•r man initialiserer kunden for √• endre MVA-sats og valuta. Som standard initialiseres kunden med 0,25¬†% MVA og ¬´NOK¬ª som valuta.</p>
<div class="highlight"><pre style="color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000080"># Kunde med null MVA og amerikanske dollar som valuta.</span>
kunde <span style="color:#39c">=</span> hammer_faktura<span style="color:#39c">.</span>Kunde(<span style="color:#cd0000">&#34;Kunde AS&#34;</span>, <span style="color:#cd0000">&#34;123456789&#34;</span>, <span style="color:#cd0000">&#34;Adresseveien 4&#34;</span>, vat<span style="color:#39c">=</span><span style="color:#cd00cd">0.00</span>, valuta<span style="color:#39c">=</span><span style="color:#cd0000">&#34;USD&#34;</span>)
</code></pre></div><p>P√• dette stadiet har man ogs√• mulighet til √• endre andre standarder. For eksempel kan forfallsdato eller fakturadato endres manuelt, om du vil gi kunden litt lenger frist.</p>
<div class="highlight"><pre style="color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000080"># Endre fakturadato og forfallsdato manuelt</span>
generator<span style="color:#39c">.</span>faktura<span style="color:#39c">.</span>dato <span style="color:#39c">=</span> <span style="color:#cd0000">&#34;10.05.1997&#34;</span>
generator<span style="color:#39c">.</span>faktura<span style="color:#39c">.</span>forfall <span style="color:#39c">=</span> <span style="color:#cd0000">&#34;10.07.1997&#34;</span>
</code></pre></div><h3 id="2-mat-inn-alle-oppdrag">2. Mat inn alle oppdrag</h3>
<p>N√• som rammeopplysningene er p√• plass, kan vi legge inn noen oppdrag vi vil fakturere kunden for. For hvert oppdrag m√• vi legge inn en leveringsdato, en id, en beskrivelse og et bel√∏p. Leveringsdato, ID og bekreftelse er tekst, mens bel√∏pet er et naturlig tall (floating point) som vi skal utf√∏re mattestykker p√•.</p>
<div class="highlight"><pre style="color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000080"># Her lager jeg en liste med 3 fiktive oppdrag</span>
<span style="color:#000080"># Hvert av de fiktive oppdragene ligger i en dictionary.</span>
alle_oppdrag <span style="color:#39c">=</span> [{<span style="color:#cd0000">&#34;leveringsdato&#34;</span>: <span style="color:#cd0000">&#34;01.01.2020&#34;</span>,
                <span style="color:#cd0000">&#34;id&#34;</span>: <span style="color:#cd0000">&#34;001&#34;</span>,
                <span style="color:#cd0000">&#34;navn&#34;</span>: <span style="color:#cd0000">&#34;Oversettelse nettside&#34;</span>,
                <span style="color:#cd0000">&#34;bel√∏p&#34;</span>: <span style="color:#cd00cd">1200.00</span>
                },
                {<span style="color:#cd0000">&#34;leveringsdato&#34;</span>: <span style="color:#cd0000">&#34;05.01.2020&#34;</span>,
                <span style="color:#cd0000">&#34;id&#34;</span>: <span style="color:#cd0000">&#34;002&#34;</span>,
                <span style="color:#cd0000">&#34;navn&#34;</span>: <span style="color:#cd0000">&#34;Korrekturlesning&#34;</span>,
                <span style="color:#cd0000">&#34;bel√∏p&#34;</span>: <span style="color:#cd00cd">432.30</span>
                },
                {<span style="color:#cd0000">&#34;leveringsdato&#34;</span>: <span style="color:#cd0000">&#34;06.01.2020&#34;</span>,
                <span style="color:#cd0000">&#34;id&#34;</span>: <span style="color:#cd0000">&#34;004&#34;</span>,
                <span style="color:#cd0000">&#34;navn&#34;</span>: <span style="color:#cd0000">&#34;Skj√∏nnlitteratur oversettelse&#34;</span>,
                <span style="color:#cd0000">&#34;bel√∏p&#34;</span>: <span style="color:#cd00cd">1223.00</span>
                }]
</code></pre></div><p>Det er lurt √• p√• en eller annen m√•te strukturere dataene p√• en forutsigbar m√•te. I dette tilfellet har jeg laget en liste. Listen inneholder 3 unike gjenstander. Hver gjenstand representerer √©n jobb, og inneholder 4 n√∏kkel-verdi-par som inneholder de fire opplysningene jeg beh√∏ver (i Python er dette en <em>dictonary</em>, en samling med data strukturert som n√∏kkel-verdi-par)</p>
<div class="highlight"><pre style="color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000080"># Loop over alle oppdragene i datasettet.</span>
<span style="color:#000080"># Legg inn id, navn, type, bel√∏p, enhet og leveringsdato.</span>
<span style="color:#000080"># Gjenta for alle oppdragene som skal med.</span>
<span style="color:#cdcd00">for</span> oppdrag <span style="color:#cdcd00">in</span> alle_oppdrag:
	generator<span style="color:#39c">.</span>add_to_invoice(oppdrag[<span style="color:#cd0000">&#34;leveringsdato&#34;</span>],
							oppdrag[<span style="color:#cd0000">&#34;id&#34;</span>],
							oppdrag[<span style="color:#cd0000">&#34;navn&#34;</span>],
							oppdrag[<span style="color:#cd0000">&#34;bel√∏p&#34;</span>])
</code></pre></div><p>N√• kan jeg loope over de tre gjenstandene i listen min. Jeg kaller metoden <code>faktura.add_to_invoice</code> p√• hver gjenstand, slik at informasjonen blir lagt inn i faktura-generatoren.</p>
<p>Takket v√¶re den nye fordelingen med netto-brutto-utregning for hver eneste fakturapost, kan vi n√• ogs√• endre MVA-satsen p√• enkelte poster. Dette kan v√¶re nyttig om du skal fakturere med ulike MVA-satser.</p>
<p>I eksempelet nedenfor skal jeg fakturere en jobb som av en eller annen grunn har en annen MVA-sats. Da legger jeg til et fjerde, valgfritt argument som sier at MVA-satsen p√• denne jobben skal v√¶re 12¬†%, i stedet for de 25¬†%-ene som er standard p√• overordnet niv√• (fra <code>generator.kunde.vat</code>)</p>
<div class="highlight"><pre style="color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">generator<span style="color:#39c">.</span>add_to_invoice(<span style="color:#cd0000">&#34;07.01.2020&#34;</span>, <span style="color:#cd0000">&#34;0007&#34;</span>, <span style="color:#cd0000">&#34;Oversettelse skatteregler&#34;</span>, <span style="color:#cd00cd">1310.23</span>, vat<span style="color:#39c">=</span><span style="color:#cd00cd">0.12</span>)
</code></pre></div><h3 id="3-generer-fakturaen-og-skriv-til-fil">3. Generer fakturaen og skriv til fil</h3>
<div class="highlight"><pre style="color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000080"># Generer tabellen.</span>
<span style="color:#000080"># Generer s√• selve fakturaen og lagre den i en variabel.</span>
generator<span style="color:#39c">.</span>generate_table()
html_fil <span style="color:#39c">=</span> generator<span style="color:#39c">.</span>generate_body()

<span style="color:#000080"># Skriv fakturaen til en fil.</span>
<span style="color:#000080"># (Bruk fakturanummret i filnavnet for bedre oversikt.)</span>
<span style="color:#cdcd00">with</span> <span style="color:#cd00cd">open</span>(f<span style="color:#cd0000">&#34;invoices/obs_faktura_{generator.faktura.id}.html&#34;</span>, <span style="color:#cd0000">&#34;w&#34;</span>) <span style="color:#cdcd00">as</span> f:
	f<span style="color:#39c">.</span>write(html_fil)
</code></pre></div><p>Resten fungerer som f√∏r. Ved √• kalle <code>generator.generate_table()</code>, vil tabellen til fakturaen skapes. Neste kall til <code>generator.generate_body()</code> legger tabellen, kundeinformasjon, bankinformasjon og fakturainformasjon inn i selve HTML-dokumentet og returnerer det. Jeg lagrer det returnerte objektet i variabelen html_fil, og skriver den til en fil. Filen markerer jeg med fakturanummeret, som jeg har tilgang til via <code>generator.faktura.id</code>.</p>
<p><a href="/obs_faktura_9159.html">Her kan du se den ferdige fakturaen.</a></p>
<p>Det er alt som trengs for √• ¬´programmatisk¬ª skape en faktura. N√• burde det meste ligge til rette for √• automatisere hele prosessen, for eksempel ved √• binde Hammer Faktura inn i et skript som laster informasjonen om utf√∏rte oppdrag ned fra XTRF-installasjonen til kunden din.</p>
<h2 id="andre-forbedringer">Andre forbedringer</h2>
<p>Det er ogs√• noen andre forbedringer jeg er forn√∏yd med med tanke p√• organisering av kode.</p>
<p>N√• ligger alle byggesteinene til dokumentet lagret som maler i HTML-format i en og samme mappe. Det gj√∏r det enda enklere √• arbeide med utformingen til fakturaene, uten √• gj√∏re endringer i Python-koden.</p>
<div class="highlight"><pre style="color:#ccc;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">hammer_faktura<span style="color:#39c">/</span>
<span style="">‚îú‚îÄ‚îÄ</span> __init__<span style="color:#39c">.</span>py
<span style="">‚îî‚îÄ‚îÄ</span> maler
    <span style="">‚îú‚îÄ‚îÄ</span> fakturamal<span style="color:#39c">.</span>html
    <span style="">‚îú‚îÄ‚îÄ</span> style<span style="color:#39c">.</span>html
    <span style="">‚îú‚îÄ‚îÄ</span> tabellmal<span style="color:#39c">.</span>html
    <span style="">‚îî‚îÄ‚îÄ</span> tr_elem_mal<span style="color:#39c">.</span>html
</code></pre></div><p>Dessuten har jeg lagt CSS-stilene inn i et eget HTML-dokument, som jeg legger inn i headeren til fakturaen. Dermed er fakturaen et helt frittst√•ende HTML-dokument hvor alt er synlig, litt som HTML-dokumentene til hjemmesiden min.</p>
<hr>
<p><strong>Obs:</strong></p>
<p>Siden jeg la ut denne bloggposten har jeg oppdatert Hammer Faktura igjen. N√• har jeg lagt til st√∏tte for databaser.</p>
<p><a href="/blogg/hammer-faktura-versjon-3">Les bloggposten om versjon 3 av Hammer Faktura her</a>.</p>
<p><a href="/blogg/fakturagenerator-i-python">Les bloggposten om den f√∏rste utgaven av Hammer Faktura her</a>.</p>

</content>


<hr>
<p style="text-align: center;"><a href="/blogg/">Tilbake til bloggoversikten</a></p>
<h4>Tagger:</h4>
<p>
  
  <a href="https://www.olehammersland.com/blogg/automatisering/">#automatisering</a>
  
  <a href="https://www.olehammersland.com/blogg/effektivisering/">#effektivisering</a>
  
  <a href="https://www.olehammersland.com/blogg/python/">#python</a>
  
  <a href="https://www.olehammersland.com/blogg/xtrf/">#xtrf</a>
  
  <a href="https://www.olehammersland.com/blogg/enkeltpersonforetak/">#enkeltpersonforetak</a>
  
</p>







  </main>
  <footer>Kontakt: <a href="mailto:post@olehammersland">post@olehammersland.com</a>
</footer>

  
  <script src=/bundle.js></script>
</body>

</html>
